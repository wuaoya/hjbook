<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="renderer" content="webkit">
    <title></title>
    <link rel="stylesheet" href="css/pintuer.css">
    <link rel="stylesheet" href="css/admin.css">
    <script src="js/jquery.js"></script>
    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="js/pintuer.js"></script>
</head>
<body onload="getEditInfo()">
<div class="panel admin-panel">
    <div class="panel-head"><strong class="icon-reorder">编辑书籍</strong></div>
    <div class="panel admin-panel margin-top" id="add">
        <div class="panel-head"><strong><span class="icon-pencil-square-o"></span>修改信息</strong></div>
        <div class="body-content">
            <div  class="form-x" >
                <div class="form-group">
                    <div class="label">
                        <label>书籍编号：</label>
                    </div>
                    <div class="field">
                        <input type="text" id="id" class="input w50" name="id" data-validate="required:请填写商品编号"  />
                        <div class="tips"></div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="label">
                        <label>书籍名称：</label>
                    </div>
                    <div class="field">
                        <input type="text" id="bookName" class="input w50" name="bookName" data-validate="required:请填写商品名称"  />
                        <div class="tips"></div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="label">
                        <label>作者：</label>
                    </div>
                    <div class="field">
                        <input type="text" id="bookAuthor" class="input w50" name="bookAuthor" data-validate="required:请填写商品名称"  />
                        <div class="tips"></div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="label">
                        <label>作品类型：</label>
                    </div>
                    <div class="field">
                        <input type="text" id="bookType" class="input w50" name="bookType" data-validate="required:请填写商品名称"  />
                        <div class="tips"></div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="label">
                        <label>发布网站：</label>
                    </div>
                    <div class="field">
                        <textarea type="text" id="bookWebsite" class="input" name="bookWebsite" style="height:80px;" value=""></textarea>
                        <div class="tips"></div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="label">
                        <label>简介：</label>
                    </div>
                    <div class="field">
                        <textarea type="text" id="description" class="input" name="description" style="height:80px;" value=""></textarea>
                        <div class="tips"></div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="label">
                        <label></label>
                    </div>
                    <div class="field">
                        <button class="button bg-main icon-check-square-o" id="goodsSub1" type="submit"> 提交</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    function editBook(info) {

            $('#id').val(info.id),
            $('#bookName').val(info.bookName),
            $('#bookAuthor').val(info.bookAuthor),
            $('#bookType').val(info.bookType),
            $('#bookWebsite').val(info.bookWebsite),
            $('#description').val(info.description)

    }
    function getEditInfo() {
        var url = location.search; //获取url中"?"符后的字串
        var editBookId = url.substr(1).split("=")[1];
        var path = "http://127.0.0.1:8080";
        $.get(
            path+"/book/selectBookById",
            {"id":editBookId},
            function (data) {
               if(data.code == 200){
                   var info = data.data;
                   editBook(info);
               }
            }
        );

    }


    $('#goodsSub1').click(function () {
        var path = "http://127.0.0.1:8080";
        var myform = {
          "id": $('#id').val(),
          "bookName": $('#bookName').val(),
          "bookAuthor": $('#bookAuthor').val(),
          "bookType": $('#bookType').val(),
          "bookWebsite": $('#bookWebsite').val(),
          "description": $('#description').val()
        };

        $.ajax({
            url: path+"/book/modifyBook",
            type: "PUT",
            data: JSON.stringify(myform),
            contentType: "application/json",
            dataType:"json",
            beforeSend:function () {
            },
            success:function (data) {
                if(data.code == 200){
                    window.location.href = path + "/background/goods-operation.html";
                }
            },
            error:function () {
                alert("编辑书籍失败！");
            }

        });
        $.put({

        });
    });
</script>
</html>